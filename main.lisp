(in-package :sento-user)
(defun main ()
  (format t "Starting CVE HUNT~%")
  (load (uiop:native-namestring (uiop:merge-pathnames* "init.lisp" (uiop:getcwd))))
  (init-time-agent)
  (init-db-agent)
  (start-login-refresher 60)
  (start-runner 1600)
  (defvar bulk-check-file (uiop:merge-pathnames* ".bulk-load" (uiop:getcwd)))
  (if (not (uiop:file-exists-p bulk-check-file))
      (progn
        (bulk-load *cve-repo*)
        (with-open-file (stream bulk-check-file
                                :direction :output
                                :if-exists :supersede)))))

(main)
